<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Hedron</title>
	<meta content="script-src 'self' 'unsafe-inline';" http-equiv="Content-Security-Policy" />
	<script src="figure.js" type="text/javascript"></script>
	<link href="https://fonts.gstatic.com" rel="preconnect">
	<link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Nova+Mono&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono&display=swap" rel="stylesheet">
	<link href="node_modules/@fortawesome/fontawesome-free/css/all.css" rel="stylesheet" type="text/css">
	<link href="styles/bootstrap_3_3_7.css" rel="stylesheet" type="text/css">
	<link href="styles/data.css" rel="stylesheet" type="text/css">
	<link href="styles/theme.css" rel="stylesheet" type="text/css">
</head>
<body>
		<div class="data-card" id="data-viewport"></div>
	</div>
	<script>

		let figure = new FIGURE();
		let screen = { x: 0, y: 0 };

		///////////////////////////////////////////////////////////////////////////
		// FUNCTIONS //////////////////////////////////////////////////////////////

		function get_element_size(html_element) {
			const s = { x: 0, y: 0 };
			s.x = html_element.offsetWidth;
			s.y = html_element.offsetHeight;
			return s;
		}

		function get_screen_size() {
			const s = { x: 0, y: 0 };
			s.x = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
			s.y = Math.max(document.documentElement.clientHeight || 0, window.innerHeight || 0);
			return s;
		}

		///////////////////////////////////////////////////////////////////////////
		// IPC COMMUNICATION //////////////////////////////////////////////////////

		window.api.receive('toRender', async (arg) => {
			if (arg.command) {
				switch (arg.command) {

					// core commands
					case 'bounce': { window.api.send('toMain', { command: arg.subcommand, success: arg.success, data: arg.data }); break; }
					case 'console.log': { console.log(arg.data); break; }
					case 'console.log json': { console.log(JSON.parse(arg.data)); break; }
					case 'initialize': { screen = get_screen_size(); break; }
					case 'window_resize': { screen = get_screen_size(); break; }

					//aplication-specific commands
					case 'signalink': {
						const data_viewport = document.getElementById('data-viewport');
						const size = { x: 0, y: 0 };
						size.x = (screen.x - 50).toString() + 'px';
						size.y = Math.floor((screen.y * 0.66) - 50).toString() + 'px';
						data_viewport.style.width = size.x;
						data_viewport.style.height = size.y;
						const network = new figure.NETWORK(arg.data, data_viewport);
						break;
					}

					default: { break; }

				} 
			}
		});

	</script>
</body>
</html>